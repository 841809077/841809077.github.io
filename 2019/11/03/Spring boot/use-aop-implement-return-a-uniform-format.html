<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><meta name="keywords" content="Ambari、Java、Kafka、HBase、Elasticsearch、GoLang、Kubernetes、Prometheus"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/qrcode.css"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><link rel="stylesheet" type="text/css" href="https://unpkg.com/gitalk/dist/gitalk.css?v=2.0.4"><title>用心整理 | Spring AOP 干货文章，图文并茂，附带 AOP 示例 ~ | ━Start。平常心_</title></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">用心整理 | Spring AOP 干货文章，图文并茂，附带 AOP 示例 ~</h1><a id="logo" href="/.">━Start。平常心_</a><p class="description">作者：create17，座右铭：每一个成功人士的背后，必定曾经做出过勇敢而又孤独的决定。放弃不难，但坚持很酷~</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 主页</i></a><a href="/archives/"><i class="fa fa-archive"> 文章时间轴</i></a><a href="/about/"><i class="fa fa-user"> 自我介绍</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">用心整理 | Spring AOP 干货文章，图文并茂，附带 AOP 示例 ~</h1><div class="post-meta"><a href="/2019/11/03/Spring boot/use-aop-implement-return-a-uniform-format.html#comments" class="comment-count"></a><p><span class="date">2019-11-03</span><span><a href="/categories/springboot/" class="category">springboot</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><div id="vip-container"><blockquote>
<p>Spring AOP 是 Java 面试的必考点，我们需要了解 AOP 的基本概念及原理。那么 Spring AOP 到底是啥，为什么面试官这么喜欢问它呢？本文先介绍 AOP 的基本概念，然后根据 AOP 原理，实现一个接口返回统一格式的小示例，方便大家理解 Spring AOP 到底如何用！</p>
</blockquote>
<h3 id="一、为什么要使用-AOP-？"><a href="#一、为什么要使用-AOP-？" class="headerlink" title="一、为什么要使用 AOP ？"></a>一、为什么要使用 AOP ？</h3><a id="more"></a>
<p>在实际的开发过程中，我们的应用程序会被分为很多层。通常来讲一个 Java 的 Web 程序会拥有以下几个层次：</p>
<ul>
<li>Web 层：主要是暴露一些 Restful API 供前端调用。</li>
<li>业务层：主要是处理具体的业务逻辑。</li>
<li>数据持久层：主要负责数据库的相关操作（增删改查）。</li>
</ul>
<p>虽然看起来每一层都做着全然不同的事情，但是实际上总会有一些类似的代码，比如日志打印和异常处理等。如果我们选择在每一层都独立编写这部分代码，那么久而久之代码将变的很难维护。所以我们提供了另外的一种解决方案：AOP。这样可以保证这些通用的代码被聚合在一起维护，而且我们可以灵活的选择何处需要使用这些代码。</p>
<h3 id="二、什么是-AOP-？"><a href="#二、什么是-AOP-？" class="headerlink" title="二、什么是 AOP ？"></a>二、什么是 AOP ？</h3><p>AOP（Aspect Oriented Programming，面向切面编程），可以说是 OOP（Object Oriented Programing，面向对象编程）的补充和完善。OOP 引入封装、继承和多态性等概念来建立一种对象层次结构，用来模拟公共行为的一个集合。当我们需要为分散的对象引入公共行为的时候，OOP则显得无能为力。也就是说，OOP 允许你定义从上到下的关系，但并不适合定义从左到右的关系。例如日志功能，日志代码往往水平地散布在所有对象层次中，而与它所散布到的对象的核心功能毫无关系。对于其他类型的代码，如权限管理、异常处理等也是如此。这种散布在各处的无关的代码被称为横切（cross-cutting）代码，在 OOP 设计中，它导致了大量代码的重复，而不利于各个模块的重用。</p>
<p>而 AOP 技术则恰恰相反，它利用一种称为 “横切” 的技术，剖解开封装的对象内部，并将那些影响了多个类的公共行为封装到一个可重用模块，并将其名为 “Aspect” ，即切面。<strong>所谓“切面”，简单地说，就是将权限、事务、日志、异常等与业务逻辑相对独立的功能抽取封装，便于减少系统的重复代码，降低模块间的耦合度，增加代码的可维护性。</strong>AOP 代表的是一个横向的关系，如果说 “对象” 是一个空心的圆柱体，其中封装的是对象的属性和行为；那么面向切面编程，就仿佛一把利刃，将这些空心圆柱体剖开，以获得其内部的消息，然后又以巧夺天功的妙手将这些剖开的切面复原，不留痕迹。</p>
<p><strong>切面理解</strong>：用刀将西瓜分成两瓣，切开的切口就是切面；炒菜、锅与炉子共同来完成炒菜，锅与炉子就是切面。Web 层级设计中，Controller 层、Service 层、Dao 层，每一层之间也是一个切面。编程中，对象与对象之间，方法与方法之间，模块与模块之间都是一个个切面。</p>
<p>推荐网上的一篇通俗易懂的 AOP 理解：<a href="https://blog.csdn.net/qukaiwei/article/details/50367761" target="_blank" rel="noopener">https://blog.csdn.net/qukaiwei/article/details/50367761</a> 。</p>
<h3 id="三、AOP-使用场景"><a href="#三、AOP-使用场景" class="headerlink" title="三、AOP 使用场景"></a>三、AOP 使用场景</h3><ul>
<li>权限控制</li>
<li>日志存储</li>
<li>统一异常处理</li>
<li>缓存处理</li>
<li>事务处理</li>
<li>……</li>
</ul>
<h3 id="四、AOP-专业术语"><a href="#四、AOP-专业术语" class="headerlink" title="四、AOP 专业术语"></a>四、AOP 专业术语</h3><p>AOP有很多专业术语，初看这么多术语，可能一下子不大理解，多读几遍，相信很快就会搞懂。</p>
<h4 id="1、Advice（通知）"><a href="#1、Advice（通知）" class="headerlink" title="1、Advice（通知）"></a>1、Advice（通知）</h4><ul>
<li>前置通知（Before advice）：在目标方法调用前执行通知</li>
<li>环绕通知（Around advice）：在目标方法调用前后均可执行自定义逻辑</li>
<li>返回通知（After returning advice）：在目标方法执行成功后，调用通知</li>
<li>异常通知（After throwing advice）：在目标方法抛出异常后，执行通知</li>
<li>后置通知（After advice）：在目标方法完成（不管是抛出异常还是执行成功）后执行通知</li>
</ul>
<h4 id="2、JoinPoint（连接点）"><a href="#2、JoinPoint（连接点）" class="headerlink" title="2、JoinPoint（连接点）"></a>2、JoinPoint（连接点）</h4><p>就是 Spring 允许你放通知（Advice）的地方，很多，基本每个方法的前、后（两者都有也行）或抛出异常时都可以是连接点，Spring 只支持方法连接点，和方法有关的前前后后都是连接点。</p>
<p><strong>Tips：</strong>可以使用连接点获取执行的类名、方法名和参数名等。</p>
<h4 id="3、Pointcut（切入点）"><a href="#3、Pointcut（切入点）" class="headerlink" title="3、Pointcut（切入点）"></a>3、Pointcut（切入点）</h4><p>是在连接点的基础上来定义切入点。比如在一个类中，有 15 个方法，那么就会有几十个连接点，但只想让其中几个方法的前后或抛出异常时干点什么，那么就用切入点来定义这几个方法，让切入点来筛选连接点。</p>
<h4 id="4、Aspect（切面）"><a href="#4、Aspect（切面）" class="headerlink" title="4、Aspect（切面）"></a>4、Aspect（切面）</h4><p>是通知（Advice）和切入点（Pointcut）的结合，通知（Advice）说明了干什么和什么时候（通过@Before、@Around、@After、@AfterReturning、@AfterThrowing来定义执行时间点）干，切入点（Pointcut）说明了在哪（指定方法）干，这就是一个完整的切面定义。</p>
<h4 id="5、AOP-代理"><a href="#5、AOP-代理" class="headerlink" title="5、AOP 代理"></a>5、AOP 代理</h4><p>AOP Proxy：AOP 框架创建的对象，代理就是目标对象的加强。AOP 巧妙的例用<strong>动态代理</strong>优雅的解决了 OOP 力所不及的问题。Spring 中的 AOP 代理可以是 jdk 动态代理，也可以是 cglib 动态代理。前者基于接口，后者基于子类。</p>
<h3 id="五、AOP-示例：实现-Spring-接口返回统一（正常-异常）格式"><a href="#五、AOP-示例：实现-Spring-接口返回统一（正常-异常）格式" class="headerlink" title="五、AOP 示例：实现 Spring 接口返回统一（正常/异常）格式"></a>五、AOP 示例：实现 Spring 接口返回统一（正常/异常）格式</h3><p>读完上面这么多抽象概念，如果不来一个 AOP 具体示例，吸收效果或者理解深度可能不是那么好。所以，请接着往下看：</p>
<h4 id="1、定义返回格式"><a href="#1、定义返回格式" class="headerlink" title="1、定义返回格式"></a>1、定义返回格式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Result</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// code 状态值：0 代表成功，其他数值代表失败</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// msg 返回信息。如果code为0，msg则为success；如果code为1，msg则为error</span></span><br><span class="line">    <span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// data 返回结果集，使用泛型兼容不同的类型</span></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2、定义一些已知异常"><a href="#2、定义一些已知异常" class="headerlink" title="2、定义一些已知异常"></a>2、定义一些已知异常</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ExceptionEnum &#123;</span><br><span class="line"></span><br><span class="line">    UNKNOW_ERROR(-<span class="number">1</span>, <span class="string">"未知错误"</span>),</span><br><span class="line">    NULL_EXCEPTION(-<span class="number">2</span>, <span class="string">"空指针异常：NullPointerException"</span>),</span><br><span class="line">    INVALID_EXCEPTION(<span class="number">1146</span>, <span class="string">"无效的数据访问资源使用异常：InvalidDataAccessResourceUsageException"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String msg;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3、异常类捕获并返回"><a href="#3、异常类捕获并返回" class="headerlink" title="3、异常类捕获并返回"></a>3、异常类捕获并返回</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//@ControllerAdvice</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExceptionHandle</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//    @ExceptionHandler(value = Exception.class)</span></span><br><span class="line"><span class="comment">//    @ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">exceptionGet</span><span class="params">(Throwable t)</span> </span>&#123;</span><br><span class="line">        log.error(<span class="string">"异常信息："</span>, t);</span><br><span class="line">        <span class="keyword">if</span> (t <span class="keyword">instanceof</span> InvalidDataAccessResourceUsageException) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.error(ExceptionEnum.INVALID_EXCEPTION);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (t <span class="keyword">instanceof</span> NullPointerException) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.error(ExceptionEnum.NULL_EXCEPTION);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.error(ExceptionEnum.UNKNOW_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>制作一个结果返回工具类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResultUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> com.study.spring.entity.Result</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 接口调用成功返回的数据格式</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: object</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">success</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result();</span><br><span class="line">        result.setCode(<span class="number">0</span>);</span><br><span class="line">        result.setMsg(<span class="string">"success"</span>);</span><br><span class="line">        result.setData(object);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> com.study.spring.entity.Result</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 接口调用失败返回的数据格式</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: msg</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">error</span><span class="params">(Integer code, String msg)</span> </span>&#123;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result();</span><br><span class="line">        result.setCode(code);</span><br><span class="line">        result.setMsg(msg);</span><br><span class="line">        result.setData(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 返回异常信息，在已知的范围内</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> exceptionEnum</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title">error</span><span class="params">(ExceptionEnum exceptionEnum)</span> </span>&#123;</span><br><span class="line">        Result result = <span class="keyword">new</span> Result();</span><br><span class="line">        result.setCode(exceptionEnum.code);</span><br><span class="line">        result.setMsg(exceptionEnum.msg);</span><br><span class="line">        result.setData(<span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4、pom-依赖"><a href="#4、pom-依赖" class="headerlink" title="4、pom 依赖"></a>4、pom 依赖</h4><p>必须要添加 spring aop 等相关依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- web 依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- aop 依赖 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 用于日志切面中，以 json 格式打印出入参 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- lombok 简化代码--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5、自定义注解"><a href="#5、自定义注解" class="headerlink" title="5、自定义注解"></a>5、自定义注解</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> HandleResult &#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">String <span class="title">desc</span><span class="params">()</span> <span class="keyword">default</span> "create17"</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述代码内有些概念需要解释说明：</p>
<ul>
<li>@Retention：定义注解的保留策略<ul>
<li>@Retention(RetentionPolicy.SOURCE) ：注解保留在源码中，当 Java 文件编译成 class 字节码文件的时候，注解被遗弃。</li>
<li>@Retention(RetentionPolicy.CLASS ：默认的保留策略，注解会保留在 class 字节码文件中，但运行（ jvm 加载 class 字节码文件）时会被遗弃。</li>
<li>@Retention(RetentionPolicy.RUNTIME) ：注解保留在 class 字节码文件中，在运行时也可以通过反射获取到。</li>
</ul>
</li>
<li>@Target：定义注解的作用目标，可多个，用逗号分隔。<ul>
<li>@Target(ElementType.TYPE) ：作用于接口、类、枚举、注解</li>
<li>@Target(ElementType.FIELD) ：作用于字段、枚举的常量</li>
<li>@Target(ElementType.METHOD) ：作用于方法，不包含构造方法</li>
<li>@Target(ElementType.PARAMETER) ：作用于方法的参数</li>
<li>@Target(ElementType.CONSTRUCTOR) ：作用于构造方法</li>
<li>@Target(ElementType.LOCAL_VARIABLE) ：作用于本地变量</li>
<li>@Target(ElementType.ANNOTATION_TYPE) ：作用于注解</li>
<li>@Target(ElementType.PACKAGE) ：作用于包 </li>
</ul>
</li>
<li>@Document：说明该注解将被包含在javadoc中。</li>
<li>@Inherited：说明子类可以继承父类中的该注解。</li>
<li>@interface：声明自定义注解。</li>
<li>desc()：定义一个属性，默认为 create17。具体使用为：@HandleResult(desc = “描述内容…”)</li>
</ul>
<p>到这里，一个完整的自定义注解就定义完成了。</p>
<h4 id="6、切面实现"><a href="#6、切面实现" class="headerlink" title="6、切面实现"></a>6、切面实现</h4><h5 id="1）首先我们定义一个切面类-HandleResultAspect"><a href="#1）首先我们定义一个切面类-HandleResultAspect" class="headerlink" title="1）首先我们定义一个切面类 HandleResultAspect"></a><strong>1）</strong>首先我们定义一个切面类 HandleResultAspect</h5><ul>
<li>使用 @Aspect 注解来定义切面，将当前类标识为一个切面供容器管理，必不可少。</li>
<li>使用 @Component 注解来定义组件，将当前类标识为一个组件供容器管理，也必不可少。</li>
<li>使用 @Slf4j 注解来打印日志；</li>
<li>使用 @Order(i) 注解来表示切面的顺序，后文会详细讲。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Order</span>(<span class="number">100</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandleResultAspect</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2）接下来，我们定义一个切点。"><a href="#2）接下来，我们定义一个切点。" class="headerlink" title="2）接下来，我们定义一个切点。"></a><strong>2）</strong>接下来，我们定义一个切点。</h5><p>使用 @Pointcut 来定义一个切点。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pointcut</span>(<span class="string">"@annotation(com.study.spring.annotation.HandleResult)"</span>)</span><br><span class="line"><span class="comment">// @Pointcut("execution(* com.study.spring.controller..*.*(..))")</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HandleResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于 execution 表达式，官网对 execution 表达式的介绍为：</p>
<p><strong><em>execution(&lt;修饰符模式&gt;?&lt;返回类型模式&gt;&lt;方法名模式&gt;(&lt;参数模式&gt;)&lt;异常模式&gt;?)</em></strong></p>
<p>除了返回类型模式、方法名模式和参数模式外，其它项都是可选的。这个解释可能有点难理解，下面我们通过一个具体的例子来了解一下。在 HandleResultAspect 中我们定义了一个切点，其 execution 表达式为：<code>* com.study.spring.controller..*.*(..))</code>，下表为该表达式比较通俗的解析：</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>标识符</strong></th>
<th style="text-align:left"><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>execution（）</code></td>
<td style="text-align:left">表达式的主体</td>
</tr>
<tr>
<td style="text-align:left">第一个 <code>*</code> 符号</td>
<td style="text-align:left">表示返回值的类型，<code>*</code> 代表所有返回类型</td>
</tr>
<tr>
<td style="text-align:left"><code>com.study.spring.controller</code></td>
<td style="text-align:left">AOP 所切的服务的包名，即需要进行横切的业务类</td>
</tr>
<tr>
<td style="text-align:left">包名后面的 <code>..</code></td>
<td style="text-align:left">表示当前包及子包</td>
</tr>
<tr>
<td style="text-align:left">第二个 <code>*</code></td>
<td style="text-align:left">表示类名，<code>*</code> 表示所有类</td>
</tr>
<tr>
<td style="text-align:left">最后的 <code>.*(..)</code></td>
<td style="text-align:left">第一个 <code>.</code> 表示任何方法名，括号内为参数类型，<code>..</code> 代表任何类型参数</td>
</tr>
</tbody>
</table>
<p>上述的 execution 表达式是把 com.study.spring.controller 下所有的方法当作一个切点。@Pointcut 除了可以使用 execution 表达式之外，还可用 @annotation 来指定注解切入，比如可指定上面创建的自定义注解 @HandleResult ，@HandleResult 在哪里被使用，哪里就是一个切点。</p>
<h5 id="3）说一下-Advice（通知）有关的切面注解"><a href="#3）说一下-Advice（通知）有关的切面注解" class="headerlink" title="3）说一下 Advice（通知）有关的切面注解"></a><strong>3）</strong>说一下 Advice（通知）有关的切面注解</h5><ul>
<li>@Before：修饰的方法会在进入切点之前执行。在这个部分，我们需要打印一个开始执行的日志，比如：类型、方法名、参数名等。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Before</span>(value = <span class="string">"HandleResult() &amp;&amp; @annotation(t)"</span>, argNames = <span class="string">"joinPoint,t"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">(JoinPoint joinPoint, HandleResult t)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// 类名</span></span><br><span class="line">    String className = joinPoint.getTarget().getClass().getName();</span><br><span class="line">    <span class="comment">// 方法名</span></span><br><span class="line">    String methodName = joinPoint.getSignature().getName();</span><br><span class="line">    <span class="comment">// 参数名</span></span><br><span class="line">    Object[] args = joinPoint.getArgs();</span><br><span class="line">    StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">if</span> (args != <span class="keyword">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Object arg : args) &#123;</span><br><span class="line">            sb.append(arg).append(<span class="string">", "</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    log.info(<span class="string">"接口 &#123;&#125; 开始被调用, 类名: &#123;&#125;, 方法名: &#123;&#125;, 参数名为: &#123;&#125; ."</span>,</span><br><span class="line">             t.desc(), className, methodName, sb.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>@Around：修饰的方法会环绕整个切点，可以在切入点前后织入代码，并可以自由地控制何时执行切点。通俗点讲就是：在进入切点前执行一部分逻辑，然后进入切点执行业务逻辑（ProceedingJoinPoint.proceed() 方法可用来接收业务逻辑的返回信息），最后出切点执行另一部分逻辑。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(<span class="string">"HandleResult()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Result <span class="title">doAround</span><span class="params">(ProceedingJoinPoint point)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">    log.info(<span class="string">"---HandleResultAspect--Around的前半部分----------------------------"</span>);</span><br><span class="line">    Object result;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 执行切点。point.proceed 为方法返回值</span></span><br><span class="line">        result = point.proceed();</span><br><span class="line">        <span class="comment">// 打印出参</span></span><br><span class="line">        log.info(<span class="string">"接口原输出内容: &#123;&#125;"</span>, <span class="keyword">new</span> Gson().toJson(result));</span><br><span class="line">        <span class="comment">// 执行耗时</span></span><br><span class="line">        log.info(<span class="string">"执行耗时：&#123;&#125; ms"</span>, System.currentTimeMillis() - startTime);</span><br><span class="line">        <span class="keyword">return</span> ResultUtil.success(result);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">        <span class="keyword">return</span> exceptionHandle.exceptionGet(throwable);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>@After：修饰的方法和 @Before 相对应，无论程序执行正常还是异常，均执行该方法。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@After</span>(<span class="string">"HandleResult()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"doAfter..."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>@AfterReturning：在切点正常执行后，执行该方法，一般用于对返回值做些加工处理的场景。</li>
</ul>
<p>returning 可接收接口最终地返回信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterReturning</span>(pointcut = <span class="string">"@annotation(t)"</span>, returning = <span class="string">"res"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturn</span><span class="params">(HandleResult t, Object res)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"接口 &#123;&#125; 被调用已结束, 最终返回结果为: &#123;&#125; ."</span>,</span><br><span class="line">             t.desc(), <span class="keyword">new</span> Gson().toJson(res));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>@AfterThrowing：在切点抛出异常后，执行该方法。</li>
</ul>
<p>throwing 可用来获取异常信息。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AfterThrowing</span>(throwing = <span class="string">"throwable"</span>, pointcut = <span class="string">"HandleResult()"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Throwable throwable)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">"After throwing..."</span>, throwable);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于这些通知的执行顺序如下图所示：</p>
<p><img src="https://gcore.jsdelivr.net/gh/841809077/blog-img/20190601/20191110201041.png" alt></p>
<p>以下为切面实现的全部代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@Order</span>(<span class="number">100</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandleResultAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ExceptionHandle exceptionHandle;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 定义切点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"@annotation(com.study.spring.annotation.HandleResult)"</span>)</span><br><span class="line"><span class="comment">//    @Pointcut("execution(* com.study.spring.controller..*.*(..))")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">HandleResult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 打印接口名、类名、方法名及参数名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: joinPoint</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: t</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Before</span>(value = <span class="string">"@annotation(t)"</span>, argNames = <span class="string">"joinPoint,t"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doBefore</span><span class="params">(JoinPoint joinPoint, HandleResult t)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">// 类名</span></span><br><span class="line">        String className = joinPoint.getTarget().getClass().getName();</span><br><span class="line">        <span class="comment">// 方法名</span></span><br><span class="line">        String methodName = joinPoint.getSignature().getName();</span><br><span class="line">        <span class="comment">// 参数名</span></span><br><span class="line">        Object[] args = joinPoint.getArgs();</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">if</span> (args != <span class="keyword">null</span> &amp;&amp; args.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Object arg : args) &#123;</span><br><span class="line">                sb.append(arg).append(<span class="string">", "</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"接口 &#123;&#125; 开始被调用, 类名: &#123;&#125;, 方法名: &#123;&#125;, 参数名为: &#123;&#125; ."</span>,</span><br><span class="line">                t.desc(), className, methodName, sb.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> java.lang.Object</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 定义<span class="doctag">@Around</span>环绕，用于何时执行切点</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: proceedingJoinPoint</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"HandleResult()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">doAround</span><span class="params">(ProceedingJoinPoint point)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line">        log.info(<span class="string">"---HandleResultAspect--Around的前半部分----------------------------"</span>);</span><br><span class="line">        Object result;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 执行切点。point.proceed 为方法返回值</span></span><br><span class="line">            result = point.proceed();</span><br><span class="line">            <span class="comment">// 打印出参</span></span><br><span class="line">            log.info(<span class="string">"接口原输出内容: &#123;&#125;"</span>, <span class="keyword">new</span> Gson().toJson(result));</span><br><span class="line">            <span class="comment">// 执行耗时</span></span><br><span class="line">            log.info(<span class="string">"执行耗时：&#123;&#125; ms"</span>, System.currentTimeMillis() - startTime);</span><br><span class="line">            <span class="keyword">return</span> ResultUtil.success(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            <span class="keyword">return</span> exceptionHandle.exceptionGet(throwable);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 程序无论正常还是异常，均执行的方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"HandleResult()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"doAfter..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 当程序运行正常，所执行的方法</span></span><br><span class="line"><span class="comment">     * 以json格式打印接口执行结果</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: t</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: res</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterReturning</span>(pointcut = <span class="string">"@annotation(t)"</span>, returning = <span class="string">"res"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturn</span><span class="params">(HandleResult t, Object res)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"接口 &#123;&#125; 被调用已结束, 接口最终返回结果为: &#123;&#125; ."</span>,</span><br><span class="line">                t.desc(), <span class="keyword">new</span> Gson().toJson(res));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 当程序运行异常，所执行的方法</span></span><br><span class="line"><span class="comment">     * 可用来打印异常</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>: throwable</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AfterThrowing</span>(throwing = <span class="string">"throwable"</span>, pointcut = <span class="string">"HandleResult()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">(Throwable throwable)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"After throwing..."</span>, throwable);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="六、多切面的执行顺序"><a href="#六、多切面的执行顺序" class="headerlink" title="六、多切面的执行顺序"></a>六、多切面的执行顺序</h3><p>在生产中，我们的项目可能不止一个切面，那么在多切面的情况下，如何指定切面的优先级呢？</p>
<p>我们可以使用 @Order(i) 注解来定义切面的优先级，i 值越小，优先级越高。</p>
<p>比如我们再创建一个切面，代码示例如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Order</span>(<span class="number">50</span>)</span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAspect2</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"@annotation(com.study.spring.annotation.HandleResult)"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">aa</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"aa()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bb</span><span class="params">(JoinPoint joinPoint)</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 Before 方法..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"aa()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">cc</span><span class="params">(ProceedingJoinPoint point)</span></span>&#123;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 Around 方法的前半部分..."</span>);</span><br><span class="line">        Object result = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            result = point.proceed();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 Around 方法的后半部分..."</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"aa()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 After 方法..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterReturning</span>(<span class="string">"aa()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterReturn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 AfterReturning 方法..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@AfterThrowing</span>(<span class="string">"aa()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterThrowing</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">"我是 TestAspect2 的 AfterThrowing 方法..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>切面 TestAspect2 为 @Order(50)，之前的切面 HandleResultAspect 为 Order(100)。测试接口返回的日志如下图所示：</p>
<p><img src="https://gcore.jsdelivr.net/gh/841809077/blog-img/20190601/20191110221432.png" alt></p>
<p>总结一下规律就是：</p>
<ul>
<li>在执行切点之前，@Order 从小到大被执行，也就是说 Order 越小的优先级越高；</li>
<li>在执行切点之后，@Order 从大到小被执行，也就是说 Order 越大的优先级越高；</li>
</ul>
<p>也就是：<strong>先进后出</strong>的原则。为了方便我们理解，我画了一个图，如下图所示：</p>
<p><img src="https://gcore.jsdelivr.net/gh/841809077/blog-img/20190601/20191110221548.png" alt></p>
<h3 id="七、如何设置在特定环境下使用AOP"><a href="#七、如何设置在特定环境下使用AOP" class="headerlink" title="七、如何设置在特定环境下使用AOP"></a>七、如何设置在特定环境下使用AOP</h3><p>一般在项目开发中，都会设置三个环境：开发、测试、生产。那么如果我只想在 开发 和 测试 环境下使用某切面该怎么办呢？我们只需要在指定的切面类上方加上注解 @Profile 就可以了，如下所示：</p>
<p><img src="https://gcore.jsdelivr.net/gh/841809077/blog-img/20191101/20191110224125.png" alt></p>
<p>这样就指定了 HandleResultAspect 该切面只能在 dev（开发）环境、test（测试）环境下生效，prod（生产）环境不生效。当然，你需要创建相应的 application-${dev/test/prod}.yml 文件，最后在 application.yml 文件内指定 spring.profiles.active 属性为 dev 或 test 才可以生效。</p>
<h3 id="八、总结"><a href="#八、总结" class="headerlink" title="八、总结"></a>八、总结</h3><p>本文篇幅较长，但总算对 Spring AOP 有了一个简单的了解。从 AOP 的起源到概念、使用场景，然后深入了解其专业术语，利用 AOP 思想实现了示例，方便我们自己理解。读完这篇文章，相信大家可以基本不惧面试官对这个知识点的考核了！</p>
<p>本文所涉及的代码已上传至 github ：</p>
<p><a href="https://github.com/841809077/spring-boot-study/tree/master/src/main/java/com/study/spring/annotation" target="_blank" rel="noopener">https://github.com/841809077/spring-boot-study/tree/master/src/main/java/com/study/spring/annotation</a></p>
<p>本文参考链接：</p>
<ul>
<li><a href="https://www.exception.site/springboot/spring-boot-aop-web-request" target="_blank" rel="noopener">https://www.exception.site/springboot/spring-boot-aop-web-request</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-spring-boot-aop-web-log-processing-and-distributed-locking/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/java/j-spring-boot-aop-web-log-processing-and-distributed-locking/index.html</a></li>
<li><a href="https://blog.csdn.net/w05980598/article/details/79070388" target="_blank" rel="noopener">https://blog.csdn.net/w05980598/article/details/79070388</a></li>
</ul>
<hr>
</div>

			<script src="https://my.openwrite.cn/js/readmore.js" type="text/javascript"></script>
			<script>
			var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);
			if (!isMobile) {
			    var btw = new BTWPlugin();
			    btw.init({
			        "id": "vip-container",
			        "blogId": "15743-1570943068343-906",
			        "name": "大数据实战演练",
			        "qrcode": "https://gcore.jsdelivr.net/gh/841809077/blog-img/20181110/20181118235726.jpg",
			        "keyword": "vip"
			    });
			}
			</script>
		</div><strong>再见</strong><br><hr class="bottom_msg"><br><h3><a href="#点关注，不迷路" title="点关注，不迷路" class="headerlink">点关注，不迷路</a></h3><br><p>好了各位，以上就是这篇文章的全部内容了，能看到这里的人呀，都是<strong>人才</strong>。</p><br><p><strong>白嫖不好，创作不易。</strong>各位的支持和认可，就是我创作的最大动力，我们下篇文章见！</p><br><p>如果本篇博客有任何错误，请批评指教，不胜感激 ！</p><br><div class="post-qrcode"><div class="qrcode_bar center"><img src="/img/qrcode.png" title="扫一扫交个朋友" alt="微信公众号二维码" width="100%"></div></div><script type="text/javascript" src="/js/jquery.js?v=2.0.4" async></script><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>坚持原创技术分享，您的支持将鼓励我继续创作！<br></div></div><div id="donate_guide" class="donate_bar center hidden pay"><img src="/img/weChatMoney.png" id="wechatpay" title="微信打赏" alt="微信打赏"><img src="/img/alipayMoney.png" id="alipay" title="支付宝打赏" alt="支付宝打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    // $('#donate_board').addClass('hidden');
    // $('#donate_guide').removeClass('hidden');
    $('#donate_guide').toggle();
}</script></div><script type="text/javascript" src="/js/jquery.fancybox.js?v=2.0.4" async></script><script type="text/javascript" src="/js/wrapImage.js?v=2.0.4" async></script><div class="post-copyright"><blockquote><p>原文作者: create17</p><p>原文链接: <a href="https://841809077.github.io/2019/11/03/Spring boot/use-aop-implement-return-a-uniform-format.html">https://841809077.github.io/2019/11/03/Spring boot/use-aop-implement-return-a-uniform-format.html</a></p><p>版权声明: 转载请注明出处(码字不易，请保留作者署名及链接，谢谢配合！)</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2019/11/18/ELK/elk-install.html" class="pre">Elasticsearch + Logstash + Kibana 安装（全）</a><a href="/2019/10/24/Spring boot/Sptring-IOC.html" class="next">Spring IOC，看完这篇文章，我才算是懂了！</a></div><div id="comments"><div id="container"><script type="text/javascript" src="https://unpkg.com/gitalk/dist/gitalk.min.js?v=2.0.4"></script><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=2.0.4"></script><script>var gitalk = new Gitalk({
  clientID: '7ff674ca1078ead070aa',
  clientSecret: 'f176d4d73417fd566e3e0ac6319aeb4708f4099d',
  repo: '841809077.github.io',
  owner: '841809077',
  admin: ['841809077'],
  id: md5(window.location.pathname),
  distractionFreeMode: false,
  language: 'zh-CN',
  pagerDirection: 'last'
})
gitalk.render('container')</script></div></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#一、为什么要使用-AOP-？"><span class="toc-text">一、为什么要使用 AOP ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#二、什么是-AOP-？"><span class="toc-text">二、什么是 AOP ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#三、AOP-使用场景"><span class="toc-text">三、AOP 使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四、AOP-专业术语"><span class="toc-text">四、AOP 专业术语</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、Advice（通知）"><span class="toc-text">1、Advice（通知）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、JoinPoint（连接点）"><span class="toc-text">2、JoinPoint（连接点）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、Pointcut（切入点）"><span class="toc-text">3、Pointcut（切入点）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、Aspect（切面）"><span class="toc-text">4、Aspect（切面）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、AOP-代理"><span class="toc-text">5、AOP 代理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#五、AOP-示例：实现-Spring-接口返回统一（正常-异常）格式"><span class="toc-text">五、AOP 示例：实现 Spring 接口返回统一（正常/异常）格式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1、定义返回格式"><span class="toc-text">1、定义返回格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2、定义一些已知异常"><span class="toc-text">2、定义一些已知异常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3、异常类捕获并返回"><span class="toc-text">3、异常类捕获并返回</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4、pom-依赖"><span class="toc-text">4、pom 依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5、自定义注解"><span class="toc-text">5、自定义注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6、切面实现"><span class="toc-text">6、切面实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1）首先我们定义一个切面类-HandleResultAspect"><span class="toc-text">1）首先我们定义一个切面类 HandleResultAspect</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2）接下来，我们定义一个切点。"><span class="toc-text">2）接下来，我们定义一个切点。</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3）说一下-Advice（通知）有关的切面注解"><span class="toc-text">3）说一下 Advice（通知）有关的切面注解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#六、多切面的执行顺序"><span class="toc-text">六、多切面的执行顺序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#七、如何设置在特定环境下使用AOP"><span class="toc-text">七、如何设置在特定环境下使用AOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#八、总结"><span class="toc-text">八、总结</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/03/13/ELK/Elasticsearch/API/es-query-dsl.html">Elasticsearch Query DSL 查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/11/09/ELK/Elasticsearch/疑难问题/fielddata-data-too-large.html">Elasticsearch查询报错：FIELDDATA Data is too large</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/12/ELK/Elasticsearch/Client/elasticsearch-bool-query.html">Elasticsearch bool复合查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/12/ELK/Elasticsearch/Client/Elasticsearch-7.6.2-client-query.html">Elasticsearch-7.6.2客户端查询指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/11/Prometheus/prometheus-query-functions.html">Prometheus常用查询函数梳理</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/10/07/ELK/Elasticsearch/Client/Elasticsearch-7.6.2-xpack-java-client.html">Elasticsearch-7.6.2部署并开启xpack，java客户端明文密码连接指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/09/30/Prometheus/Exporter/rabbitmq-exporter.html">RabbitMQ exporter部署</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/09/20/GoLang/go-time-usage.html">golang 时间相关操作集合</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/12/Ambari/运维相关/hdp-copmonment-version.html">如何查看HDP各组件版本信息，两种办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/28/Docker/docker-faq.html">docker 常见问题解答汇总</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-weixin"> 微信公众号</i></div><img width="100%" height="100%" title="微信扫一扫，订阅更多技术干货" alt="啊哦，图片丢失了... 加我微信: create17_，联系我吧" src="/img/prcode_square.jpg"/></div><div class="widget"><div class="widget-title"><i class="iconfont2 iconscan"> 加我好友（与我互动）</i></div><div class="img-po"><img width="100%" height="100%" title="微信扫一扫，欢迎与我交流！" alt="微信号: create17_，欢迎与我交流！" src="/img/wechat_code.jpg"/></div></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AlertManager/">AlertManager</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ambari/">Ambari</a><span class="category-list-count">33</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ELK/">ELK</a><span class="category-list-count">21</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/EmberJS/">EmberJS</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/FastDFS/">FastDFS</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Flume/">Flume</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GoLang/">GoLang</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HBase/">HBase</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HDFS/">HDFS</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HUE/">HUE</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hadoop/">Hadoop</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java工具类/">Java工具类</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/K8s/">K8s</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kafka/">Kafka</a><span class="category-list-count">17</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kerberos/">Kerberos</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kettle/">Kettle</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kylin/">Kylin</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">16</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MongoDB/">MongoDB</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PostgreSQL/">PostgreSQL</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Prometheus/">Prometheus</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scala/">Scala</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Scrapy爬虫框架/">Scrapy爬虫框架</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Solr/">Solr</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Sqoop/">Sqoop</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zookeeper/">Zookeeper</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go语言/">go语言</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo搭建个人博客/">hexo搭建个人博客</a><span class="category-list-count">11</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/springboot/">springboot</a><span class="category-list-count">22</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/yarn/">yarn</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/你有酒我有故事/">你有酒我有故事</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/开发工具/">开发工具</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/浏览器插件/">浏览器插件</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/hadoop服务组件/" style="font-size: 15px;">hadoop服务组件</a> <a href="/tags/Hadoop服务组件/" style="font-size: 15px;">Hadoop服务组件</a> <a href="/tags/security/" style="font-size: 15px;">security</a> <a href="/tags/ntp/" style="font-size: 15px;">ntp</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/Kylin/" style="font-size: 15px;">Kylin</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/python实战/" style="font-size: 15px;">python实战</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/ambari/" style="font-size: 15px;">ambari</a> <a href="/tags/自定义服务/" style="font-size: 15px;">自定义服务</a> <a href="/tags/书籍福利/" style="font-size: 15px;">书籍福利</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">五月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">四月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">十月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="https://blog.csdn.net/CREATE_17" title="CSDN - CREATE_17" target="_blank">CSDN - CREATE_17</a><ul></ul><a href="https://www.iteblog.com/" title="过往记忆 的大数据博客" target="_blank">过往记忆 的大数据博客</a><ul></ul><a href="https://shirukai.github.io/" title="Rukai Shi 的大数据博客" target="_blank">Rukai Shi 的大数据博客</a><ul></ul><a href="https://liunaijie.github.io/" title="蒙娜丽莎法师" target="_blank">蒙娜丽莎法师</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">create17.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>